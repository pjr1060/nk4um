<?xml version="1.0" encoding="UTF-8"?>
<nk4um:page xmlns:nk4um="http://onegch.org.uk/netkernel/nk4um"
            xmlns:xrl="http://netkernel.org/xrl">
  <nk4um:title>nk4um Add Post</nk4um:title>
  <nk4um:heading>nk4um Add Post</nk4um:heading>
  <nk4um:head>
    <script type="text/javascript">
      $(function() {
        $("#reply-content").keyup(function () {
          $.post("/nk4um/post/preview", { post : $(this).val() }, function(data) {
            $("#contentPreview").html(data);
          }, "html");
        });
      
        $("#topicTable").dataTable({
          "bJQueryUI": true,
          "sPaginationType": "full_numbers",
          "aaSorting": [[1,'desc']],
          "aoColumns": [ null,
                         { "sType": "iso-date" }
                       ]
        });
      });
    </script>
  </nk4um:head>
  <nk4um:breadcrumbs>
    <xrl:include>
      <xrl:identifier>nk4um:web:topic:breadcrumbs</xrl:identifier>
      <xrl:argument name="id">arg:id</xrl:argument>
    </xrl:include>
  </nk4um:breadcrumbs>
  <nk4um:content>
    <form class="styled-form" action="doAdd" method="POST">
      <div class="form-header">
        <h3>Post Reply</h3>
      </div>
      <div class="form-body">
        <div>
          <label for="title">Title:</label>
          <input type="text" name="title"/>
        </div>
        <div>
          <label for="content">Content:</label>
          <textarea name="content" id="reply-content"/>
        </div>
      </div>
      <div>
        <div class="label">Preview:</div>
        <div class="form-body-content" id="contentPreview" style="width: 620px; margin: 0; margin-bottom: 6px; padding: 4px; border: 1px solid darkGrey; height: 150px; overflow: scroll;">
        </div>
      </div>
      <div class="form-footer">
        <button type="submit">Post Reply</button>
      </div>
    </form>
    <h2>Topic Recap</h2>
    <table id="topicTable"
           class="forumTable"
           xmlns:xrl="http://netkernel.org/xrl">
      <thead>
        <tr>
          <th class="fixedColumn">Poster</th>
          <th class="stretchedColumn">Content</th>
        </tr>
      </thead>
      <tbody class="forumGroup">
        <xrl:include>
          <xrl:identifier>nk4um:web:topic:postList</xrl:identifier>
          <xrl:argument name="id">arg:id</xrl:argument>
        </xrl:include>
      </tbody>
    </table>
  </nk4um:content>
</nk4um:page>
