<html xmlns:xrl="http://netkernel.org/xrl"
      xmlns:nk4um="http://onegch.org.uk/netkernel/nk4um">
  <head>
    <title><nk4um:title/></title>
    
    <link href="/nk4um/style/jquery-ui-1.8.5.custom.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="/nk4um/style/jquery-1.4.2.min.js"/>
    <script type="text/javascript" src="/nk4um/style/jquery.dataTables.min.js"/>
    
    <link href="/nk4um/style/main.css" rel="stylesheet" type="text/css"/>
    
    <script type="text/javascript">
      $.fn.dataTableExt.afnSortData['last-post'] = function  ( oSettings, iColumn ) {
        var aData = [];
        $( 'td:eq('+iColumn+') .post-date', oSettings.oApi._fnGetTrNodes(oSettings) ).each( function () {
          aData.push($(this).text());
        } );
        
        return aData;
      }
      
      $(document).ready(function() {
        $("#topicTable").dataTable({
          "bJQueryUI": true,
          "sPaginationType": "full_numbers"
        });
        
        var columns;
        
        if ($("#forumTable thead tr th").size() == 6) {
          columns= [ null,
                     null,
                     null,
                     { "sSortDataType": "last-post" },
                     null,
                     { "bVisible":    false }
                   ];
        } else {
          columns= [ null,
                     null,
                     null,
                     { "sSortDataType": "last-post", "sType": "date" },
                     { "bVisible":    false }
                   ];
        }
        
        $("#forumTable").dataTable({
          "bJQueryUI": true,
          "sPaginationType": "full_numbers",
          "aaSorting": [[3,'desc']],
          "aaSortingFixed": [[$("#forumTable thead tr th").size() - 1,'asc']],
          "aoColumns": columns
        });
        
        $(".dataTables_filter input").get(0).type="search";
        $(".dataTables_wrapper .fg-toolbar:first-child").append($("#button-bar"));
      });
    </script>
    
    <nk4um:head/>
  </head>
  <body>
    <div id="content">
      <div id="header">
        <div id="header-content">
          <div id="site-buttons">
            <xrl:include>
              <xrl:identifier>nk4um:web:navigation</xrl:identifier>
            </xrl:include>
          </div>
          <h1><nk4um:heading/></h1>
          <div id="tag-line"><nk4um:tagLine/></div>
        </div>
        <div id="breadcrumbs">
          <nk4um:breadcrumbs/>
        </div>
      </div>
      
      
      <xrl:include>
        <xrl:identifier>nk4um:web:message</xrl:identifier>
      </xrl:include>
      
      <nk4um:content/>
      
    </div>
  </body>
</html>
